"use strict";angular.module("interactionsApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("interactionsApp").controller("MainCtrl",["$scope","$http","$q",function(a,b,c){function d(){return!a.medicalProducts.length||a.medicalProducts.length<2||!a.conditions.length?void(a.interactions=[]):void b.get(e+"/interactions?medicinalproducts="+a.medicalProducts.join(",")+"&preexistingconditions="+a.conditions.join(",")).then(function(b){a.interactions=b.data.results},function(){alert("error fetching response")})}var e="";a.showMedicinalProducts=!0,a.medicalProductsPrefix="",a.medicalProducts=[],a.medicalProductsBuffer=[];var f=c.defer();a.$watch("medicalProductsPrefix",function(d){console.log("medicalProductsPrefix",d),!d||d.length<4||(f.resolve,f=c.defer(),b.get(e+"/medicinalproducts?startsWith="+d,{timeout:f.promise}).then(function(b){a.medicalProductsBuffer=b.data.drugs.filter(function(b){return-1===a.medicalProducts.indexOf(b)}),console.log("response",b.data,a.medicalProductsBuffer)},function(){alert("error fetching response")}))}),a.addMedicalProduct=function(b){a.showConditions=!0,a.medicalProductsPrefix="",a.medicalProductsBuffer=[],a.medicalProducts.push(b),d()},a.removeMedicalProduct=function(b){a.medicalProducts.splice(a.medicalProducts.indexOf(b),1),d()},a.conditionsPrefix="",a.conditions=[],a.conditionsBuffer=[];var g=c.defer();a.$watch("conditionsPrefix",function(d){!d||d.length<4||(g.resolve,g=c.defer(),b.get(e+"/preexistingconditions?startsWith="+d,{timeout:g.promise}).then(function(b){a.conditionsBuffer=b.data.conditions.filter(function(b){return-1===a.conditions.indexOf(b)})},function(){alert("error fetching response")}))}),a.addCondition=function(b){a.showInteractions=!0,a.conditionsPrefix="",a.conditionsBuffer=[],a.conditions.push(b),d()},a.removeCondition=function(b){a.conditions.splice(a.medicalProducts.indexOf(b),1),d()},a.interactions=[]}]);